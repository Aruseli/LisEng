# –ê–Ω–∞–ª–∏–∑ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã –∏ –Ω–µ–¥–æ—Å—Ç–∞—é—â–∏—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤

## –¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ

### ‚úÖ –ß—Ç–æ —É–∂–µ –µ—Å—Ç—å:
1. **–ú–∏–≥—Ä–∞—Ü–∏–∏ –ë–î** - —Å–æ–∑–¥–∞–Ω–∞ –º–∏–≥—Ä–∞—Ü–∏—è –¥–ª—è –≤—Å–µ—Ö —Ç–∞–±–ª–∏—Ü –∏–∑ DB.sql
2. **Hasyx queries** - –ø–µ—Ä–µ–ø–∏—Å–∞–Ω—ã –≤—Å–µ queries/mutations –Ω–∞ hasyx –≤–º–µ—Å—Ç–æ GraphQL
3. **AI Service** - —É–ª—É—á—à–µ–Ω ClaudeService —Å retry –∏ –æ–±—Ä–∞–±–æ—Ç–∫–æ–π –æ—à–∏–±–æ–∫
4. **Stage Progression** - —Å–µ—Ä–≤–∏—Å –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏ –∫ –ø–µ—Ä–µ—Ö–æ–¥—É –º–µ–∂–¥—É —ç—Ç–∞–ø–∞–º–∏

### ‚ùå –ß—Ç–æ –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç:

## 1. –ì–ª–æ–±–∞–ª—å–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ (Zustand/Context)

**–ü—Ä–æ–±–ª–µ–º–∞:** –í `AppPage.tsx` –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –ª–æ–∫–∞–ª—å–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ (`useState`), —á—Ç–æ –ø—Ä–∏–≤–æ–¥–∏—Ç –∫:
- –ù–µ—Ç —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ –¥–∞–Ω–Ω—ã—Ö –º–µ–∂–¥—É –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞–º–∏
- –ù–µ—Ç –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- –ù–µ—Ç –æ–ø—Ç–∏–º–∏—Å—Ç–∏—á–Ω—ã—Ö –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π
- –°–ª–æ–∂–Ω–æ —É–ø—Ä–∞–≤–ª—è—Ç—å –∑–∞–≥—Ä—É–∑–∫–æ–π –¥–∞–Ω–Ω—ã—Ö

**–†–µ—à–µ–Ω–∏–µ:** –°–æ–∑–¥–∞—Ç—å Zustand stores:

```typescript
// stores/user-store.ts
- user: User | null
- currentStage: Stage | null
- streak: Streak | null
- loadUser()
- updateUser()

// stores/tasks-store.ts
- tasks: DailyTask[]
- selectedDate: Date
- loadTasks(date)
- completeTask(id)
- refreshTasks()

// stores/vocabulary-store.ts
- cards: VocabularyCard[]
- currentCard: VocabularyCard | null
- loadCardsForReview()
- reviewCard(cardId, wasCorrect)

// stores/progress-store.ts
- metrics: ProgressMetrics[]
- loadMetrics(startDate, endDate)
- refreshMetrics()
```

## 2. –†–∞–∑–±–∏–µ–Ω–∏–µ AppPage –Ω–∞ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã

**–¢–µ–∫—É—â–∞—è –ø—Ä–æ–±–ª–µ–º–∞:** –û–¥–∏–Ω –±–æ–ª—å—à–æ–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç (460 —Å—Ç—Ä–æ–∫) —Å–æ –≤—Å–µ–π –ª–æ–≥–∏–∫–æ–π

**–ü—Ä–µ–¥–ª–∞–≥–∞–µ–º–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞:**

```
components/
  app/
    AppPage.tsx (–≥–ª–∞–≤–Ω—ã–π –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä)
    Header.tsx
    Navigation.tsx
    RitualScreen.tsx
    
    dashboard/
      DashboardTab.tsx
      GreetingCard.tsx
      ProgressRing.tsx
      TasksList.tsx
      QuickStats.tsx
      
    vocabulary/
      VocabularyTab.tsx
      VocabularyCard.tsx
      CardReview.tsx
      
    ai/
      AIPracticeTab.tsx
      ChatMessages.tsx
      ChatInput.tsx
      
    progress/
      ProgressTab.tsx
      ProgressChart.tsx
      AchievementsList.tsx
```

## 3. –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Hasyx hooks

**–ü—Ä–æ–±–ª–µ–º–∞:** –ò—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è mock –¥–∞–Ω–Ω—ã–µ –≤–º–µ—Å—Ç–æ —Ä–µ–∞–ª—å–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤

**–†–µ—à–µ–Ω–∏–µ:** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `useSelect`, `useMutation` –∏–∑ hasyx:

```typescript
// –í–º–µ—Å—Ç–æ useState —Å mock –¥–∞–Ω–Ω—ã–º–∏
const { data: tasks, loading, refetch } = useSelect({
  table: 'daily_tasks',
  where: { 
    user_id: { _eq: userId },
    task_date: { _eq: today }
  },
  returning: [...]
}, { skip: !userId });
```

## 4. –û–±—Ä–∞–±–æ—Ç–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –∏ –æ—à–∏–±–æ–∫

**–û—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç:**
- Loading states –¥–ª—è –≤—Å–µ—Ö –∑–∞–ø—Ä–æ—Å–æ–≤
- Error boundaries
- Retry –ª–æ–≥–∏–∫–∞ –¥–ª—è failed requests
- Empty states (–∫–æ–≥–¥–∞ –Ω–µ—Ç –¥–∞–Ω–Ω—ã—Ö)

## 5. –û–ø—Ç–∏–º–∏—Å—Ç–∏—á–Ω—ã–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è

**–û—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç:**
- –ü—Ä–∏ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–∏ –∑–∞–¥–∞—á–∏ - —Å—Ä–∞–∑—É –æ–±–Ω–æ–≤–∏—Ç—å UI, –ø–æ—Ç–æ–º —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞—Ç—å —Å —Å–µ—Ä–≤–µ—Ä–æ–º
- –ü—Ä–∏ –ø–æ–≤—Ç–æ—Ä–µ–Ω–∏–∏ —Å–ª–æ–≤–∞ - —Å—Ä–∞–∑—É –æ–±–Ω–æ–≤–∏—Ç—å –∫–∞—Ä—Ç–æ—á–∫—É

## 6. –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö

**–û—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç:**
- –ö—ç—à –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏—Ö –¥–∞–Ω–Ω—ã—Ö
- –ö—ç—à –¥–ª—è –∑–∞–¥–∞–Ω–∏–π
- –ò–Ω–≤–∞–ª–∏–¥–∞—Ü–∏—è –∫—ç—à–∞ –ø—Ä–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è—Ö

## 7. Real-time –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è

**–û—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç:**
- –ü–æ–¥–ø–∏—Å–∫–∏ –Ω–∞ –∏–∑–º–µ–Ω–µ–Ω–∏—è –∑–∞–¥–∞–Ω–∏–π
- –ü–æ–¥–ø–∏—Å–∫–∏ –Ω–∞ –ø—Ä–æ–≥—Ä–µ—Å—Å
- WebSocket –¥–ª—è real-time —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π

## 8. –í–∞–ª–∏–¥–∞—Ü–∏—è –∏ –æ–±—Ä–∞–±–æ—Ç–∫–∞ —Ñ–æ—Ä–º

**–û—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç:**
- –í–∞–ª–∏–¥–∞—Ü–∏—è –≤–≤–æ–¥–∞ –≤ AI —á–∞—Ç–µ
- –í–∞–ª–∏–¥–∞—Ü–∏—è –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –∑–∞–¥–∞—á
- –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ –≤–∞–ª–∏–¥–∞—Ü–∏–∏

## 9. –ü–µ—Ä—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å —Å–æ—Å—Ç–æ—è–Ω–∏—è

**–û—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç:**
- –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤—ã–±—Ä–∞–Ω–Ω–æ–π –≤–∫–ª–∞–¥–∫–∏ –≤ localStorage
- –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –Ω–∞—Å—Ç—Ä–æ–µ–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è –ø–æ—Å–ª–µ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∏

## 10. –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

**–û—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç:**
- Unit —Ç–µ—Å—Ç—ã –¥–ª—è –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤
- Integration —Ç–µ—Å—Ç—ã –¥–ª—è stores
- E2E —Ç–µ—Å—Ç—ã –¥–ª—è –æ—Å–Ω–æ–≤–Ω—ã—Ö flow

## –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ OPTIONS/ITEMS —Å–∏—Å—Ç–µ–º–∞–º

### OPTIONS —Å–∏—Å—Ç–µ–º–∞

**–ü–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è:**
- ‚úÖ –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (timezone, preferences)
- ‚úÖ –ú–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ –∑–∞–¥–∞–Ω–∏–π (tags, custom fields)
- ‚úÖ –í—Ä–µ–º–µ–Ω–Ω—ã–µ —Ñ–ª–∞–≥–∏ (feature flags –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è)

**–ù–µ –ø–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è:**
- ‚ùå –û—Å–Ω–æ–≤–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ (–∑–∞–¥–∞–Ω–∏—è, —Å–ª–æ–≤–∞) - —ç—Ç–æ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –æ—Ç–¥–µ–ª—å–Ω—ã–µ —Ç–∞–±–ª–∏—Ü—ã
- ‚ùå –°–≤—è–∑–∞–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ —Å –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–æ–π

**–ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è:**
```typescript
// –í schema.tsx
export const options = {
  users: z.object({
    preferredTheme: z.enum(['light', 'dark']).optional(),
    notificationSettings: z.object({
      email: z.boolean().optional(),
      push: z.boolean().optional(),
    }).optional(),
  }),
  daily_tasks: z.object({
    customNote: z.string().optional(),
    priority: z.enum(['low', 'medium', 'high']).optional(),
  }),
};
```

### ITEMS —Å–∏—Å—Ç–µ–º–∞

**–ü–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è:**
- ‚úÖ –ò–µ—Ä–∞—Ä—Ö–∏—á–µ—Å–∫–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –∫—É—Ä—Å–æ–≤/—É—Ä–æ–∫–æ–≤
- ‚úÖ –ù–∞—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ –Ω–∞—Å—Ç—Ä–æ–µ–∫ –æ—Ç —ç—Ç–∞–ø–∞ –∫ –∑–∞–¥–∞–Ω–∏—é
- ‚úÖ –ì—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞ –∑–∞–¥–∞–Ω–∏–π –ø–æ —Ç–µ–º–∞–º

**–ù–µ –ø–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è:**
- ‚ùå –ü–ª–æ—Å–∫–∏–µ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã (—Å–ª–æ–≤–∞, –æ—à–∏–±–∫–∏) - –ø—Ä–æ—â–µ –æ–±—ã—á–Ω—ã–µ —Ç–∞–±–ª–∏—Ü—ã
- ‚ùå –ü—Ä–æ—Å—Ç—ã–µ —Å–≤—è–∑–∏ - –ª—É—á—à–µ foreign keys

**–ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è:**
```typescript
// –ï—Å–ª–∏ –Ω—É–∂–Ω–∞ –∏–µ—Ä–∞—Ä—Ö–∏—è: –ö—É—Ä—Å ‚Üí –≠—Ç–∞–ø ‚Üí –£—Ä–æ–∫ ‚Üí –ó–∞–¥–∞–Ω–∏–µ
// –¢–æ–≥–¥–∞ –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å items –¥–ª—è –∫—É—Ä—Å–æ–≤/—É—Ä–æ–∫–æ–≤
// –ò –Ω–∞—Å–ª–µ–¥–æ–≤–∞—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ —á–µ—Ä–µ–∑ item_options
```

## –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç—ã —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

### –í—ã—Å–æ–∫–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç:
1. ‚úÖ –ú–∏–≥—Ä–∞—Ü–∏–∏ –ë–î
2. ‚úÖ Hasyx queries
3. üîÑ –†–∞–∑–±–∏–µ–Ω–∏–µ AppPage –Ω–∞ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã
4. üîÑ Zustand stores –¥–ª—è –≥–ª–æ–±–∞–ª—å–Ω–æ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è
5. üîÑ –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å useSelect/useMutation

### –°—Ä–µ–¥–Ω–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç:
6. –û–±—Ä–∞–±–æ—Ç–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –∏ –æ—à–∏–±–æ–∫
7. –û–ø—Ç–∏–º–∏—Å—Ç–∏—á–Ω—ã–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è
8. –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö

### –ù–∏–∑–∫–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç:
9. Real-time –ø–æ–¥–ø–∏—Å–∫–∏
10. –ü–µ—Ä—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å —Å–æ—Å—Ç–æ—è–Ω–∏—è
11. –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

